on:
    # Trigger analysis when pushing in master or pull requests, and when creating
    # a pull request. 
    push:
      branches:
        - develop
    pull_request:
      types: [opened, synchronize, reopened]
name: Main Workflow
jobs:
sonarcloud:
  runs-on: ubuntu-latest
  steps:
  - uses: actions/checkout@v2
    with:
      # Disabling shallow clone is recommended for improving relevancy of reporting
      fetch-depth: 0
  - name: SonarScanner Install
    run: |
        export SONAR_SCANNER_VERSION=4.2.0.1873
        export SONAR_SCANNER_HOME=$HOME/.sonar/sonar-scanner-$SONAR_SCANNER_VERSION-linux
        curl --create-dirs -sSLo $HOME/.sonar/sonar-scanner.zip https://binaries.sonarsource.com/Distribution/sonar-scanner-cli/sonar-scanner-cli-$SONAR_SCANNER_VERSION-linux.zip
        unzip -o $HOME/.sonar/sonar-scanner.zip -d $HOME/.sonar/
        export PATH=$SONAR_SCANNER_HOME/bin:$PATH
        export SONAR_SCANNER_OPTS="-server"
  - name: SonarScanner Run
    run: |
        sonar-scanner \
        -Dsonar.organization=ddogadkiney \
        -Dsonar.projectKey=ddogadkiney_csharp-netcore-sca-02 \
        -Dsonar.sources=. \
        -Dsonar.host.url=https://sonarcloud.io \
        -Dsonar.login=5b7952ff4c3e991f7e9e6729c19d1be8bc75887f
